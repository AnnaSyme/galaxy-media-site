{% extends 'home/header.html' %}  {% load static %}


{% block content %}

<main>
  <div class="row justify-content-between">
    <div class="col-auto">
      <h1> Connecting to CloudStor </h1>
    </div>
    <div class="col text-end p-3">
      <a href="https://cloudstor.aarnet.edu.au">
        <img src="{% static 'home/img/cloudstor-logo.png' %}" alt="CloudStor logo" width="128px">
      </a>
    </div>
  </div>

  <br>

  <div class="container">
    <p class="lead">
      Galaxy Australia features integrations with many third-party data
      providers, including CloudStor. This document shows how to import and
      export data between your Galaxy Australia and CloudStor accounts.
    </p>
  </div>

  <hr class="mt-5">

  <div class="container py-5">

    <p class="alert alert-danger">
      CAUTION: the export tool WILL overwrite existing CloudStor files, so
      choose your target folder carefully!
    </p>

    <p>
      The import/export tools allow you to transfer one or more files to a registered
      <a href="https://www.aarnet.edu.au/network-and-services/cloud-services/cloudstor/" target="_blank">AARNet CloudStor</a>
      account. Transfers to/from CloudStor are encrypted over HTTPS.
    </p>

    <p>
      Before you can use this service, you must perform a one-off task where you
      must provide Galaxy with credentials to access your CloudStor account on
      your behalf. You must first setup an app specific password in CloudStor
      for Galaxy to use. You must then let Galaxy know what that app password
      is.
    </p>

    <h3 class="mt-5">Setting up an app password in CloudStor</h3>

    <p>
      <b>To create an app password:</b>
      <br>
      <a href="https://cloudstor.aarnet.edu.au" target="_blank">Log into your CloudStor account</a>
      and then click on "Settings" in the top right corner of the interface.
      Once in Settings you will see a menu on the left, click "Security" and you
      will see a section called app passwords.
      <br><br>
      App passwords simply require an "app name" this can be anything that helps
      you later identify the password in the future, for example "Galaxy". Fill
      in an "app name" and click "Create new app password". You will then be
      presented with a username and password/token. Your username will most
      probably be your email address and the password/token with be a randomly
      generated token. Please write this token down somewhere or copy it to your
      computer clipboard. When you click "Done" you will never be able to see
      this password/token again.
      <br><br>
      Once the app password is created you will see it in the list of app
      passwords. You can also see when that password was last used as well as
      delete the app password.
      <br><br>
      <a href="https://support.aarnet.edu.au/hc/en-us/articles/236034707-How-do-I-manage-change-my-passwords-" target="_blank">
        Click here
      </a>
      for the most up to date instructions from AARNet.
    </p>

    <h3 class="mt-5">Letting Galaxy know your app password</h3>

    <p>
      In Galaxy, go to your profile settings under the User menu -> Preferences ->
      Manage Information, where you will need to set OwnCloud/CloudStor
      Credentials.
    </p>

    <img src="{% static 'home/img/galaxy-cloudstor-profile.png' %}" alt="Galaxy CloudStor screenshot">

    <div class="my-5">
      <p>
        <b>Server URL:</b> https://cloudstor.aarnet.edu.au/plus/remote.php/webdav
      </p>
      <p>
        <b>Username:</b> The email your account is registered with
      </p>
      <p>
        <b>Password:</b> Copied from the app password set up at CloudStor
      </p>
    </div>

    <p>
      If the details above are configured properly, the next time you load the
      import/export tools, the files and directories in your CloudStor account will be
      displayed. Select the files or directory you want to transfer and click
      "Execute".
    </p>

    <p class="alert alert-warning">
      Your CloudStor credentials will be stored on this server. While reasonable
      efforts have been made to store these credentials safely, you must be
      aware and accept the risks of storing these credentials. In the event that
      the server is compromised, it may be possible for an attacker to gain
      access to your CloudStor account.
    </p>
  </div>
</main>

{% endblock %}
