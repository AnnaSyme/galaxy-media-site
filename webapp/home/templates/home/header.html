<!DOCTYPE html>
<html lang="en" dir="ltr">

{% load static %}

  <head>
    {% include 'home/snippets/head.html' %}
    <title> {% if title %}{{ title }}{% else %}Galaxy {{ GALAXY_SITE_NAME }} {{ GALAXY_SITE_SUFFIX }}{% endif %} </title>
    {% include 'home/snippets/imports.html' %}
    {% include 'home/snippets/posthog.html' %}

    {% block head %}
    {% endblock %}

    <style>
      .material-icons {
        opacity: 0;
        max-width: 2rem;
        overflow: hidden;
        transition-duration: 0.25s;
      }
    </style>
  </head>

  <body>

    <nav class="navbar fixed-top navbar-expand embedded">
      <a class="navbar-brand" href="/">
        <span class="australia">Galaxy {{ GALAXY_SITE_NAME }}</span> {{ GALAXY_SITE_SUFFIX }}
      </a>

      <div class="collapse navbar-collapse mr-auto" id="navbarNavAltMarkup">
        <div class="navbar-nav">
          <a {% if request.path == '/' %}
            class="nav-link active" href="/"
            {% else %}
            class="nav-link" href="/"
            {% endif %}>
            Home
          </a>
          <a {% if request.path|slice:":5" == '/news' %}
            class="nav-link active" href="/news"
            {% else %}
            class="nav-link" href="/news"
            {% endif %}>
            News
          </a>
          <a {% if request.path|slice:":7" == '/events' %}
            class="nav-link active" href="/events"
            {% else %}
            class="nav-link" href="/events"
            {% endif %}>
            Events
          </a>
          <a {% if request.path|slice:":7" == '/people' %}
            class="nav-link active" href="/people"
            {% else %}
            class="nav-link" href="/people"
            {% endif %}>
            People
          </a>
          <a {% if request.path|slice:":6" == '/about' %}
            class="nav-link active" href="/about"
            {% else %}
            class="nav-link" href="/about"
            {% endif %}>
            About
          </a>
          <a {% if request.path|slice:":8" == '/request' %}
              class="nav-link active" href="/request"
              {% else %}
              class="nav-link" href="/request"
              {% endif %}
          >Support</a>
          {% if user.is_staff %}
          <a class="nav-link" href="/admin" target="_blank">Admin</a>
          {% endif %}
        </div>
      </div>

      {% if not user.is_authenticated %}
      <div class="navbar-nav login">
        <a
          href="/admin"
          data-bs-toggle="tooltip"
          data-bs-placement="bottom"
          title="Admin login"
          id="admin-login"
        >Login</a>
      </div>
      {% else %}
      <div class="navbar-nav">
        <a href="/admin/logout">Log out</a>
      </div>
      {% endif %}
    </nav>


    {% block content %}
    {% endblock %}


    {% include 'home/snippets/footer.html' %}


    {% block script %}
    {% endblock %}

    <script type="text/javascript">

      // Load material icons and display when page has loaded
      document.fonts.onloadingdone = () => {
        $('.material-icons').css({
          'opacity': 1,
          'max-width': 'unset',
          'overflow': 'visible'
        });
      }

      // Determine whether page is being viewed in iframe
      function inIframe () {
        try {
            return window.self !== window.top;
        } catch (e) {
            return true;
        }
      }

      $(document).ready( () => {
        // Switch to solid navbar if not embedded in iframe
        inIframe() || $('nav').removeClass("embedded");

        // Enable bootstrap tooltips
        var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
        var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
          return new bootstrap.Tooltip(tooltipTriggerEl)
        })

        // Bubbles shown on unpublished material (admins only)
        $('.unpublished-bubble').parent().css('position', 'relative');

        // Remove links to usegalaxy.org.au if in iframe
        if ( inIframe() ) {
          $('a').each( () => {
            if (this.href.includes('usegalaxy.org.au')) {
              console.log(`Remove href from anchor: ${this.href}`);
              $(a).removeAttr("href");
            }
          });
        }

        {% block onload %}
        {% endblock %}
      });

    </script>
  </body>
</html>
